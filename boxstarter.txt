Set-WindowsExplorerOptions -EnableShowFileExtensions -EnableShowFullPathInTitleBar

Enable-MicrosoftUpdate
Install-WindowsUpdate

# Desktop apps
cinst steam slack dotnetcore-sdk hackfont chocolatey lastpass googlechrome python minecraft microsoft-windows-terminal termius barrier -y
cinst visualstudiocode-insiders --pre -y

# AWS Powershell Tools
Invoke-WebRequest -UseBasicParsing -Uri https://sdk-for-net.amazonwebservices.com/latest/AWSToolsAndSDKForNet.msi -OutFile .\AWSToolsAndSDKForNet.msi
msiexec.exe /qn /i AWSToolsAndSDKForNet.msi
del AWSToolsAndSDKForNet.msi

# Git and Powershell git helpers
cinst git -y -params '"/GitAndUnixToolsOnPath"'
cinst poshgit -y
git config --global push.default simple
git config --global user.name "Kevin Littlejohn"
git config --global user.email "kevin@littlejohn.id.au"

Update-ExecutionPolicy RemoteSigned

# Install Visual Studio Code extensions (after git because some need git)
foreach ($line in (Invoke-WebRequest -UseBasicParsing -Uri https://raw.githubusercontent.com/silarsis/windows_desktop/master/visual_studio_packages.txt).content -split "`n") { code-insiders --install-extension $line }

# Docker and Linux
Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All
Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux -All
cinst docker-for-windows -pre -y
Invoke-Reboot
